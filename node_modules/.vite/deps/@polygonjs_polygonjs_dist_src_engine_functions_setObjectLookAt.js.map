{
  "version": 3,
  "sources": ["../../@polygonjs/polygonjs/dist/src/core/LookAt.js", "../../@polygonjs/polygonjs/dist/src/core/reactivity/ObjectPropertyReactivity.js", "../../@polygonjs/polygonjs/dist/src/engine/functions/_SetObjectLookAt.js"],
  "sourcesContent": ["\"use strict\";\nimport { Vector3, Matrix4 } from \"three\";\nconst t = new Vector3();\nconst _m4 = new Matrix4();\nexport function quatLookAt(position, targetPosition, up, target) {\n  _m4.lookAt(targetPosition, position, up);\n  target.setFromRotationMatrix(_m4);\n}\nexport class CoreLookAt {\n  static applyLookAt(object, target, invert) {\n    if (invert) {\n      t.copy(object.position);\n      object.position.copy(target);\n      object.updateMatrix();\n      object.lookAt(t);\n      object.position.copy(t);\n      object.updateMatrix();\n    } else {\n      object.lookAt(target);\n    }\n  }\n}\n", "\"use strict\";\nimport { incrementRefSafely, ref } from \"../../core/reactivity/CoreReactivity\";\nexport var GetObjectPropertyJsNodeInputName = /* @__PURE__ */ ((GetObjectPropertyJsNodeInputName2) => {\n  GetObjectPropertyJsNodeInputName2[\"position\"] = \"position\";\n  GetObjectPropertyJsNodeInputName2[\"rotation\"] = \"rotation\";\n  GetObjectPropertyJsNodeInputName2[\"quaternion\"] = \"quaternion\";\n  GetObjectPropertyJsNodeInputName2[\"scale\"] = \"scale\";\n  GetObjectPropertyJsNodeInputName2[\"matrix\"] = \"matrix\";\n  GetObjectPropertyJsNodeInputName2[\"visible\"] = \"visible\";\n  GetObjectPropertyJsNodeInputName2[\"castShadow\"] = \"castShadow\";\n  GetObjectPropertyJsNodeInputName2[\"receiveShadow\"] = \"receiveShadow\";\n  GetObjectPropertyJsNodeInputName2[\"frustumCulled\"] = \"frustumCulled\";\n  GetObjectPropertyJsNodeInputName2[\"up\"] = \"up\";\n  GetObjectPropertyJsNodeInputName2[\"matrixAutoUpdate\"] = \"matrixAutoUpdate\";\n  GetObjectPropertyJsNodeInputName2[\"material\"] = \"material\";\n  return GetObjectPropertyJsNodeInputName2;\n})(GetObjectPropertyJsNodeInputName || {});\nexport const OBJECT_VECTOR3_PROPERTIES = [\n  \"position\" /* position */,\n  \"scale\" /* scale */,\n  \"up\" /* up */\n];\nexport const OBJECT_BOOLEAN_PROPERTIES = [\n  \"visible\" /* visible */,\n  \"castShadow\" /* castShadow */,\n  \"receiveShadow\" /* receiveShadow */,\n  \"frustumCulled\" /* frustumCulled */,\n  \"matrixAutoUpdate\" /* matrixAutoUpdate */\n];\nexport const OBJECT_TRANSFORM_PROPERTIES = [\n  \"position\" /* position */,\n  \"quaternion\" /* quaternion */,\n  \"scale\" /* scale */,\n  \"matrix\" /* matrix */\n];\nconst refByObjectUuidByPropertyName = /* @__PURE__ */ new Map();\nexport function getObjectPropertyRef(object3D, propertyName) {\n  let mapForObject = refByObjectUuidByPropertyName.get(object3D.uuid);\n  if (!mapForObject) {\n    mapForObject = /* @__PURE__ */ new Map();\n    refByObjectUuidByPropertyName.set(object3D.uuid, mapForObject);\n  }\n  let refForProperty = mapForObject.get(propertyName);\n  if (!refForProperty) {\n    refForProperty = ref(0);\n    mapForObject.set(propertyName, refForProperty);\n  }\n  return refForProperty;\n}\nexport function touchObjectProperties(object3D, propertyNames) {\n  const map = refByObjectUuidByPropertyName.get(object3D.uuid);\n  if (!map) {\n    return;\n  }\n  for (const propertyName of propertyNames) {\n    const _ref = map.get(propertyName);\n    if (_ref) {\n      incrementRefSafely(_ref);\n    }\n  }\n}\nexport function touchObjectProperty(object3D, propertyName) {\n  const _ref = getObjectPropertyRef(object3D, propertyName);\n  incrementRefSafely(_ref);\n}\n", "\"use strict\";\nimport { Quaternion } from \"three\";\nimport { CoreLookAt } from \"../../core/LookAt\";\nimport { isBooleanTrue } from \"../../core/Type\";\nimport { touchObjectProperty, GetObjectPropertyJsNodeInputName } from \"../../core/reactivity/ObjectPropertyReactivity\";\nimport { ObjectNamedFunction5 } from \"./_Base\";\nconst q1 = new Quaternion();\nconst q2 = new Quaternion();\nexport class setObjectLookAt extends ObjectNamedFunction5 {\n  static type() {\n    return \"setObjectLookAt\";\n  }\n  func(object3D, targetPosition, up, lerp, invertDirection, updateMatrix) {\n    object3D.up.copy(up);\n    if (lerp >= 1) {\n      CoreLookAt.applyLookAt(object3D, targetPosition, invertDirection);\n    } else {\n      q1.copy(object3D.quaternion);\n      CoreLookAt.applyLookAt(object3D, targetPosition, invertDirection);\n      q2.copy(object3D.quaternion);\n      q1.slerp(q2, lerp);\n      object3D.quaternion.copy(q1);\n    }\n    touchObjectProperty(object3D, GetObjectPropertyJsNodeInputName.quaternion);\n    if (isBooleanTrue(updateMatrix)) {\n      object3D.updateMatrix();\n      touchObjectProperty(object3D, GetObjectPropertyJsNodeInputName.matrix);\n    }\n  }\n}\n"],
  "mappings": ";;;;;;;;;;;;;;;AAEA,IAAM,IAAI,IAAI,QAAQ;AACtB,IAAM,MAAM,IAAI,QAAQ;AAKjB,IAAM,aAAN,MAAiB;AAAA,EACtB,OAAO,YAAY,QAAQ,QAAQ,QAAQ;AACzC,QAAI,QAAQ;AACV,QAAE,KAAK,OAAO,QAAQ;AACtB,aAAO,SAAS,KAAK,MAAM;AAC3B,aAAO,aAAa;AACpB,aAAO,OAAO,CAAC;AACf,aAAO,SAAS,KAAK,CAAC;AACtB,aAAO,aAAa;AAAA,IACtB,OAAO;AACL,aAAO,OAAO,MAAM;AAAA,IACtB;AAAA,EACF;AACF;;;ACnBO,IAAI,oCAAoD,CAAC,sCAAsC;AACpG,oCAAkC,UAAU,IAAI;AAChD,oCAAkC,UAAU,IAAI;AAChD,oCAAkC,YAAY,IAAI;AAClD,oCAAkC,OAAO,IAAI;AAC7C,oCAAkC,QAAQ,IAAI;AAC9C,oCAAkC,SAAS,IAAI;AAC/C,oCAAkC,YAAY,IAAI;AAClD,oCAAkC,eAAe,IAAI;AACrD,oCAAkC,eAAe,IAAI;AACrD,oCAAkC,IAAI,IAAI;AAC1C,oCAAkC,kBAAkB,IAAI;AACxD,oCAAkC,UAAU,IAAI;AAChD,SAAO;AACT,GAAG,oCAAoC,CAAC,CAAC;AAmBzC,IAAM,gCAAgD,oBAAI,IAAI;AACvD,SAAS,qBAAqB,UAAU,cAAc;AAC3D,MAAI,eAAe,8BAA8B,IAAI,SAAS,IAAI;AAClE,MAAI,CAAC,cAAc;AACjB,mBAA+B,oBAAI,IAAI;AACvC,kCAA8B,IAAI,SAAS,MAAM,YAAY;AAAA,EAC/D;AACA,MAAI,iBAAiB,aAAa,IAAI,YAAY;AAClD,MAAI,CAAC,gBAAgB;AACnB,qBAAiB,IAAI,CAAC;AACtB,iBAAa,IAAI,cAAc,cAAc;AAAA,EAC/C;AACA,SAAO;AACT;AAaO,SAAS,oBAAoB,UAAU,cAAc;AAC1D,QAAM,OAAO,qBAAqB,UAAU,YAAY;AACxD,qBAAmB,IAAI;AACzB;;;AC1DA,IAAM,KAAK,IAAI,WAAW;AAC1B,IAAM,KAAK,IAAI,WAAW;AACnB,IAAM,kBAAN,cAA8B,qBAAqB;AAAA,EACxD,OAAO,OAAO;AACZ,WAAO;AAAA,EACT;AAAA,EACA,KAAK,UAAU,gBAAgB,IAAI,MAAM,iBAAiB,cAAc;AACtE,aAAS,GAAG,KAAK,EAAE;AACnB,QAAI,QAAQ,GAAG;AACb,iBAAW,YAAY,UAAU,gBAAgB,eAAe;AAAA,IAClE,OAAO;AACL,SAAG,KAAK,SAAS,UAAU;AAC3B,iBAAW,YAAY,UAAU,gBAAgB,eAAe;AAChE,SAAG,KAAK,SAAS,UAAU;AAC3B,SAAG,MAAM,IAAI,IAAI;AACjB,eAAS,WAAW,KAAK,EAAE;AAAA,IAC7B;AACA,wBAAoB,UAAU,iCAAiC,UAAU;AACzE,QAAI,cAAc,YAAY,GAAG;AAC/B,eAAS,aAAa;AACtB,0BAAoB,UAAU,iCAAiC,MAAM;AAAA,IACvE;AAAA,EACF;AACF;",
  "names": []
}
