(self["webpackChunk"] = self["webpackChunk"] || []).push([["src_docs_search_SearchExport_vue"],{

/***/ 32987:
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

// ESM COMPAT FLAG
__webpack_require__.r(__webpack_exports__);

// EXPORTS
__webpack_require__.d(__webpack_exports__, {
  "default": function() { return /* binding */ SearchExport; }
});

// EXTERNAL MODULE: ../node_modules/@vue/runtime-core/dist/runtime-core.esm-bundler.js
var runtime_core_esm_bundler = __webpack_require__(88917);
;// CONCATENATED MODULE: ../node_modules/esbuild-loader/dist/index.cjs??clonedRuleSet-2.use[0]!../node_modules/vue-loader/dist/templateLoader.js??ruleSet[1].rules[2]!../node_modules/vue-loader/dist/index.js??ruleSet[1].rules[14].use[0]!../src/docs/search/SearchExport.vue?vue&type=template&id=da79aca6&ts=true

const _hoisted_1 = { class: "Docs-Api" };
const _hoisted_2 = /* @__PURE__ */ (0,runtime_core_esm_bundler/* createElementVNode */._)(
  "h1",
  { class: "mb-16" },
  [
    /* @__PURE__ */ (0,runtime_core_esm_bundler/* createElementVNode */._)("span", null, "Search Export")
  ],
  -1
  /* HOISTED */
);
const _hoisted_3 = [
  _hoisted_2
];
function render(_ctx, _cache, $props, $setup, $data, $options) {
  return (0,runtime_core_esm_bundler/* openBlock */.wg)(), (0,runtime_core_esm_bundler/* createElementBlock */.iD)("div", _hoisted_1, _hoisted_3);
}

;// CONCATENATED MODULE: ../src/docs/search/SearchExport.vue?vue&type=template&id=da79aca6&ts=true

// EXTERNAL MODULE: ../src/docs/search/SearchIndexController.ts + 2 modules
var SearchIndexController = __webpack_require__(96820);
// EXTERNAL MODULE: ../src/editor/core/Csrf.ts
var Csrf = __webpack_require__(6951);
// EXTERNAL MODULE: ../src/editor/store/controllers/StoreController.ts + 44 modules
var StoreController = __webpack_require__(72555);
;// CONCATENATED MODULE: ../src/docs/search/SearchExportController.ts

var __defProp = Object.defineProperty;
var __getOwnPropSymbols = Object.getOwnPropertySymbols;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __propIsEnum = Object.prototype.propertyIsEnumerable;
var __defNormalProp = (obj, key, value) => key in obj ? __defProp(obj, key, { enumerable: true, configurable: true, writable: true, value }) : obj[key] = value;
var __spreadValues = (a, b) => {
  for (var prop in b || (b = {}))
    if (__hasOwnProp.call(b, prop))
      __defNormalProp(a, prop, b[prop]);
  if (__getOwnPropSymbols)
    for (var prop of __getOwnPropSymbols(b)) {
      if (__propIsEnum.call(b, prop))
        __defNormalProp(a, prop, b[prop]);
    }
  return a;
};
var __async = (__this, __arguments, generator) => {
  return new Promise((resolve, reject) => {
    var fulfilled = (value) => {
      try {
        step(generator.next(value));
      } catch (e) {
        reject(e);
      }
    };
    var rejected = (value) => {
      try {
        step(generator.throw(value));
      } catch (e) {
        reject(e);
      }
    };
    var step = (x) => x.done ? resolve(x.value) : Promise.resolve(x.value).then(fulfilled, rejected);
    step((generator = generator.apply(__this, __arguments)).next());
  });
};


class SearchExportControllerClass {
  static instance() {
    return this._instance = this._instance || new SearchExportControllerClass();
  }
  constructor() {
  }
  clearIndex() {
    return __async(this, null, function* () {
      const url = "/docs/search/clear_index";
      const formData = new FormData();
      const response = yield fetch(url, {
        method: "POST",
        body: formData,
        headers: __spreadValues({}, Csrf/* Csrf.headers */.V.headers())
      });
      const json = yield response.json();
      console.log(json);
    });
  }
  downloadKey(key, content) {
    return __async(this, null, function* () {
      const url = "/docs/search/save_index";
      const file = new Blob([content], { type: "text/plain" });
      const formData = new FormData();
      formData.append("key", key);
      formData.append("file", file);
      const response = yield fetch(url, {
        method: "POST",
        body: formData,
        headers: __spreadValues({}, Csrf/* Csrf.headers */.V.headers())
      });
      yield response.json();
      console.log("save complete", key);
      if (response.ok) {
      } else {
        StoreController/* StoreController.editor.status.setError */.F.editor.status.setError(`search index NOT downloaded for key ${key}`);
      }
    });
  }
}
const SearchExportController = SearchExportControllerClass.instance();

;// CONCATENATED MODULE: ../node_modules/esbuild-loader/dist/index.cjs??clonedRuleSet-2.use[0]!../node_modules/vue-loader/dist/index.js??ruleSet[1].rules[14].use[0]!../src/docs/search/SearchExport.vue?vue&type=script&lang=ts
var SearchExportvue_type_script_lang_ts_async = (__this, __arguments, generator) => {
  return new Promise((resolve, reject) => {
    var fulfilled = (value) => {
      try {
        step(generator.next(value));
      } catch (e) {
        reject(e);
      }
    };
    var rejected = (value) => {
      try {
        step(generator.throw(value));
      } catch (e) {
        reject(e);
      }
    };
    var step = (x) => x.done ? resolve(x.value) : Promise.resolve(x.value).then(fulfilled, rejected);
    step((generator = generator.apply(__this, __arguments)).next());
  });
};



/* harmony default export */ var SearchExportvue_type_script_lang_ts = ((0,runtime_core_esm_bundler/* defineComponent */.aZ)({
  name: "docs-search-export",
  components: {},
  props: {},
  setup(props) {
    (0,runtime_core_esm_bundler/* onMounted */.bv)(_createExport);
    function _createExport() {
      return SearchExportvue_type_script_lang_ts_async(this, null, function* () {
        console.log("create index START");
        yield SearchIndexController/* SearchIndexController._createIndex_ */.d._createIndex_();
        console.log("create index COMPLETED");
        yield SearchExportController.clearIndex();
        console.log("create index CLEARED");
        yield SearchIndexController/* SearchIndexController.export */.d["export"]((key, data) => {
          if (data != null) {
            console.log("search exporting", key);
            SearchExportController.downloadKey(key, data);
          }
        });
      });
    }
    return {};
  }
}));

;// CONCATENATED MODULE: ../src/docs/search/SearchExport.vue?vue&type=script&lang=ts
 
// EXTERNAL MODULE: ../node_modules/vue-loader/dist/exportHelper.js
var exportHelper = __webpack_require__(6959);
;// CONCATENATED MODULE: ../src/docs/search/SearchExport.vue




;
const __exports__ = /*#__PURE__*/(0,exportHelper/* default */.Z)(SearchExportvue_type_script_lang_ts, [['render',render]])

/* harmony default export */ var SearchExport = (__exports__);

/***/ })

}])
//# sourceMappingURL=src_docs_search_SearchExport_vue.087da9619724dcebfc4d.js.map