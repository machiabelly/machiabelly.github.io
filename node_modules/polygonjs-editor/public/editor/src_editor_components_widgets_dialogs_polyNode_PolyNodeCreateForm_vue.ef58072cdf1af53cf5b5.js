(self["webpackChunk"] = self["webpackChunk"] || []).push([["src_editor_components_widgets_dialogs_polyNode_PolyNodeCreateForm_vue"],{

/***/ 38065:
/***/ (function(module, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(20559);
/* harmony import */ var _node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(93476);
/* harmony import */ var _node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__);
// Imports


var ___CSS_LOADER_EXPORT___ = _node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1___default()((_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0___default()));
// Module
___CSS_LOADER_EXPORT___.push([module.id, ".PolyNodeCreateForm{background-color:#fff}.PolyNodeCreateForm form{padding:10px}.PolyNodeCreateForm form input{margin:0}.PolyNodeCreateForm .buttons{padding:10px;margin-bottom:0px}.PolyNodeCreateForm .buttons .button{margin-bottom:0px}", "",{"version":3,"sources":["webpack://./../src/editor/components/widgets/dialogs/polyNode/PolyNodeCreateForm.vue"],"names":[],"mappings":"AAEA,oBACC,qBAAA,CAEA,yBACC,YAAA,CACA,+BACC,QAAA,CAEF,6BACC,YAAA,CACA,iBAAA,CACA,qCACC,iBAAA","sourcesContent":["\n\n.PolyNodeCreateForm\n\tbackground-color: white\n\n\tform\n\t\tpadding: 10px\n\t\tinput\n\t\t\tmargin: 0\n\n\t.buttons\n\t\tpadding: 10px\n\t\tmargin-bottom: 0px\n\t\t.button\n\t\t\tmargin-bottom: 0px\n"],"sourceRoot":""}]);
// Exports
/* harmony default export */ __webpack_exports__["default"] = (___CSS_LOADER_EXPORT___);


/***/ }),

/***/ 79187:
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

// ESM COMPAT FLAG
__webpack_require__.r(__webpack_exports__);

// EXPORTS
__webpack_require__.d(__webpack_exports__, {
  "default": function() { return /* binding */ PolyNodeCreateForm; }
});

// EXTERNAL MODULE: ../node_modules/@vue/runtime-core/dist/runtime-core.esm-bundler.js
var runtime_core_esm_bundler = __webpack_require__(88917);
// EXTERNAL MODULE: ../node_modules/@vue/runtime-dom/dist/runtime-dom.esm-bundler.js + 1 modules
var runtime_dom_esm_bundler = __webpack_require__(90996);
;// CONCATENATED MODULE: ../node_modules/esbuild-loader/dist/index.cjs??clonedRuleSet-2.use[0]!../node_modules/vue-loader/dist/templateLoader.js??ruleSet[1].rules[2]!../node_modules/vue-loader/dist/index.js??ruleSet[1].rules[14].use[0]!../src/editor/components/widgets/dialogs/polyNode/PolyNodeCreateForm.vue?vue&type=template&id=4ca31ef9&ts=true

const _hoisted_1 = {
  key: 0,
  class: "PolyNodeCreateForm"
};
const _hoisted_2 = { class: "mx-3 mb-4 mt-6 bt-2 bg-bg text-text" };
const _hoisted_3 = { class: "cell auto" };
const _hoisted_4 = { class: "div" };
const _hoisted_5 = /* @__PURE__ */ (0,runtime_core_esm_bundler/* createElementVNode */._)(
  "label",
  {
    for: "poly-create-form-node-type",
    class: "block text-sm font-medium text-text"
  },
  "Node Type",
  -1
  /* HOISTED */
);
const _hoisted_6 = { class: "mt-1" };
const _hoisted_7 = { class: "mt-2 mb-2 sm:mt-2 sm:flex sm:flex-row-reverse" };
function render(_ctx, _cache, $props, $setup, $data, $options) {
  const _component_InputsForm = (0,runtime_core_esm_bundler/* resolveComponent */.up)("InputsForm");
  const _component_Modal = (0,runtime_core_esm_bundler/* resolveComponent */.up)("Modal");
  return _ctx.displayed ? ((0,runtime_core_esm_bundler/* openBlock */.wg)(), (0,runtime_core_esm_bundler/* createElementBlock */.iD)("div", _hoisted_1, [
    (0,runtime_core_esm_bundler/* createVNode */.Wm)(_component_Modal, {
      displayed: _ctx.displayed,
      title: _ctx.title,
      ref: "modal",
      onClose: _ctx.close
    }, {
      default: (0,runtime_core_esm_bundler/* withCtx */.w5)(() => [
        (0,runtime_core_esm_bundler/* createElementVNode */._)("div", _hoisted_2, [
          (0,runtime_core_esm_bundler/* createElementVNode */._)("div", _hoisted_3, [
            (0,runtime_core_esm_bundler/* createElementVNode */._)(
              "form",
              {
                onSubmit: _cache[4] || (_cache[4] = (0,runtime_dom_esm_bundler.withModifiers)(() => {
                }, ["prevent"]))
              },
              [
                (0,runtime_core_esm_bundler/* createElementVNode */._)("div", _hoisted_4, [
                  (0,runtime_core_esm_bundler/* createCommentVNode */.kq)(' <label for="poly-create-form-node-type">Node Type</label>\n							<input\n								id="poly-create-form-node-type"\n								type="text"\n								v-model="nodeType"\n								ref="nodeTypeInput"\n								@keypress.stop=""\n								@keyup.stop=""\n								@keydown.stop=""\n							/> '),
                  _hoisted_5,
                  (0,runtime_core_esm_bundler/* createElementVNode */._)("div", _hoisted_6, [
                    (0,runtime_core_esm_bundler/* withDirectives */.wy)((0,runtime_core_esm_bundler/* createElementVNode */._)(
                      "input",
                      {
                        id: "poly-create-form-node-type",
                        type: "text",
                        name: "default-value",
                        class: "shadow appearance-none border border-black rounded w-full py-2 px-3 bg-black focus:outline-none focus:ring-0 focus:border-blue-500 text-gray-100 leading-6 transition-colors duration-200 ease-in-out border-transparent number required text-sm h-8 mb-2",
                        "onUpdate:modelValue": _cache[0] || (_cache[0] = ($event) => _ctx.nodeType = $event),
                        onKeypress: _cache[1] || (_cache[1] = (0,runtime_dom_esm_bundler.withModifiers)(() => {
                        }, ["stop"])),
                        onKeyup: _cache[2] || (_cache[2] = (0,runtime_dom_esm_bundler.withModifiers)(() => {
                        }, ["stop"])),
                        onKeydown: _cache[3] || (_cache[3] = (0,runtime_dom_esm_bundler.withModifiers)(() => {
                        }, ["stop"]))
                      },
                      null,
                      544
                      /* HYDRATE_EVENTS, NEED_PATCH */
                    ), [
                      [runtime_dom_esm_bundler.vModelText, _ctx.nodeType]
                    ])
                  ]),
                  _ctx.nodeId ? ((0,runtime_core_esm_bundler/* openBlock */.wg)(), (0,runtime_core_esm_bundler/* createBlock */.j4)(_component_InputsForm, {
                    nodeId: _ctx.nodeId,
                    showSimpleInputNames: false,
                    key: _ctx.nodeId,
                    onUpdated: _ctx.updateInputsData
                  }, null, 8, ["nodeId", "onUpdated"])) : (0,runtime_core_esm_bundler/* createCommentVNode */.kq)("v-if", true)
                ])
              ],
              32
              /* HYDRATE_EVENTS */
            )
          ]),
          (0,runtime_core_esm_bundler/* createCommentVNode */.kq)(' <div class="cell shrink text-right">\n					<div class="buttons">\n						<div class="button clear" id="dialog-prompt-cancel" @click="close">Cancel</div>\n						<div class="button success" id="dialog-prompt-ok" @click="save">\n							<span v-if="loading">Loading...</span><span v-else>Create Poly Node</span>\n						</div>\n					</div>\n				</div> '),
          (0,runtime_core_esm_bundler/* createElementVNode */._)("div", _hoisted_7, [
            (0,runtime_core_esm_bundler/* createElementVNode */._)("button", {
              id: "polynode-create-form-submit-button",
              type: "button",
              class: "inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-green-600 text-base font-medium text-white hover:bg-green-700 sm:ml-3 sm:w-auto sm:text-sm cursor-pointer",
              onClick: _cache[5] || (_cache[5] = //@ts-ignore
              (...args) => _ctx.save && _ctx.save(...args))
            }, " Create PolyNode "),
            (0,runtime_core_esm_bundler/* createElementVNode */._)("button", {
              id: "dialog-prompt-cancel",
              type: "button",
              class: "mt-3 inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-bg-medium hover:bg-bg-dark text-base font-medium text-text hover:text-text-light sm:mt-0 sm:w-auto sm:text-sm cursor-pointer",
              onClick: _cache[6] || (_cache[6] = //@ts-ignore
              (...args) => _ctx.close && _ctx.close(...args))
            }, " Cancel ")
          ])
        ])
      ]),
      _: 1
      /* STABLE */
    }, 8, ["displayed", "title", "onClose"])
  ])) : (0,runtime_core_esm_bundler/* createCommentVNode */.kq)("v-if", true);
}

;// CONCATENATED MODULE: ../src/editor/components/widgets/dialogs/polyNode/PolyNodeCreateForm.vue?vue&type=template&id=4ca31ef9&ts=true

// EXTERNAL MODULE: ../src/editor/components/widgets/dialogs/Modal.vue + 5 modules
var Modal = __webpack_require__(31445);
// EXTERNAL MODULE: ../src/editor/store/controllers/StoreController.ts + 44 modules
var StoreController = __webpack_require__(72555);
// EXTERNAL MODULE: ../src/editor/components/widgets/dialogs/polyNode/inputs/InputsForm.vue + 15 modules
var InputsForm = __webpack_require__(39641);
// EXTERNAL MODULE: ../node_modules/@vue/reactivity/dist/reactivity.esm-bundler.js + 1 modules
var reactivity_esm_bundler = __webpack_require__(61334);
// EXTERNAL MODULE: ../src/editor/Editor.ts + 11 modules
var Editor = __webpack_require__(90192);
// EXTERNAL MODULE: ../@polygonjs/polygonjs/src/engine/nodes/utils/poly/PolyNodeController.ts
var PolyNodeController = __webpack_require__(69941);
// EXTERNAL MODULE: ../@polygonjs/polygonjs/src/core/String.ts
var core_String = __webpack_require__(40065);
// EXTERNAL MODULE: ../src/editor/core/_BasePolyNodeSaveController.ts
var _BasePolyNodeSaveController = __webpack_require__(64656);
;// CONCATENATED MODULE: ../node_modules/esbuild-loader/dist/index.cjs??clonedRuleSet-2.use[0]!../node_modules/vue-loader/dist/index.js??ruleSet[1].rules[14].use[0]!../src/editor/components/widgets/dialogs/polyNode/PolyNodeCreateForm.vue?vue&type=script&lang=ts
var __async = (__this, __arguments, generator) => {
  return new Promise((resolve, reject) => {
    var fulfilled = (value) => {
      try {
        step(generator.next(value));
      } catch (e) {
        reject(e);
      }
    };
    var rejected = (value) => {
      try {
        step(generator.throw(value));
      } catch (e) {
        reject(e);
      }
    };
    var step = (x) => x.done ? resolve(x.value) : Promise.resolve(x.value).then(fulfilled, rejected);
    step((generator = generator.apply(__this, __arguments)).next());
  });
};








/* harmony default export */ var PolyNodeCreateFormvue_type_script_lang_ts = ((0,runtime_core_esm_bundler/* defineComponent */.aZ)({
  name: "poly-node-create-form",
  components: { Modal: Modal/* default */.Z, InputsForm: InputsForm/* default */.Z },
  props: {
    urlNodePath: {
      type: String,
      required: true
    }
  },
  setup(props) {
    const controller = StoreController/* StoreController.editor.polyNodeCreateForm */.F.editor.polyNodeCreateForm;
    const nodeType = (0,reactivity_esm_bundler/* ref */.iH)("myNode");
    const nodeTypeInput = (0,reactivity_esm_bundler/* ref */.iH)(null);
    const loading = (0,reactivity_esm_bundler/* ref */.iH)(false);
    const inputsData = (0,reactivity_esm_bundler/* ref */.iH)({});
    const node = StoreController/* StoreController.scene.node */.F.scene.node(controller.nodeUrlToPath(props.urlNodePath));
    (0,runtime_core_esm_bundler/* onMounted */.bv)(() => {
      if (!node) {
        controller.close();
      }
    });
    const nodeId = (0,reactivity_esm_bundler/* ref */.iH)(node == null ? void 0 : node.graphNodeId());
    const displayed = (0,runtime_core_esm_bundler/* computed */.Fl)(() => nodeId.value != null);
    function _node() {
      if (nodeId.value) {
        return StoreController/* StoreController.engine.node */.F.engine.node(nodeId.value);
      }
    }
    const title = (0,runtime_core_esm_bundler/* computed */.Fl)(() => {
      const node2 = _node();
      if (nodeId.value != null && node2) {
        return `Create Poly Node From: ${node2.path()}`;
      } else {
        return `Create Poly Node From:...`;
      }
    });
    (0,runtime_core_esm_bundler/* watch */.YP)(nodeId, (newDisplay) => {
      if (newDisplay) {
        _reset();
      }
    });
    (0,runtime_core_esm_bundler/* watch */.YP)(displayed, (newDisplay) => {
      if (newDisplay) {
        focusAndSelect();
      }
    });
    function _reset() {
      nodeType.value = "myNode";
      inputsData.value = {};
    }
    function focusAndSelect() {
      (0,runtime_core_esm_bundler/* nextTick */.Y3)(() => {
        var _a, _b;
        (_a = nodeTypeInput.value) == null ? void 0 : _a.focus();
        (_b = nodeTypeInput.value) == null ? void 0 : _b.select();
      });
    }
    function updateInputsData(data) {
      inputsData.value = data;
    }
    function save() {
      return __async(this, null, function* () {
        const node2 = _node();
        if (!node2) {
          console.warn("no node to save polynode from");
          return;
        }
        if (nodeType.value.trim().length == 0) {
          alert("nodeType must not be empty");
          return;
        }
        nodeType.value = core_String/* CoreString.sanitizeName */.YE.sanitizeName(nodeType.value);
        const username = StoreController/* StoreController.editor.currentUser.username */.F.editor.currentUser.username().value || void 0;
        if (loading.value == true) {
          return;
        }
        loading.value = true;
        const polyNodeData = {
          node_context: node2.context(),
          node_type: nodeType.value,
          username,
          data: yield PolyNodeController/* PolyNodeController.polyNodeData */.C.polyNodeData(node2, inputsData.value)
        };
        if (node2.io.inputs.hasNamedInputs()) {
          const params = polyNodeData.data.params;
          if (params) {
            const newParams = params.filter((param) => {
              var _a;
              const isSpare = (_a = param.options) == null ? void 0 : _a.spare;
              return isSpare;
            });
            polyNodeData.data.params = newParams;
          }
        }
        Editor/* Editor.instance */.M.instance().createPolyNode({
          node: node2,
          polyNodeData,
          callback: (newNode) => {
            loading.value = false;
            close();
            if (newNode) {
              if (_BasePolyNodeSaveController/* BasePolyNodeSaveController.DEBUG_LEVEL */.g.DEBUG_LEVEL >= 0) {
                console.log("polyNode creation COMPLETE", newNode.graphNodeId(), newNode.path());
              }
              StoreController/* StoreController.editor.polyNodeUpdateForm.show */.F.editor.polyNodeUpdateForm.show({ node: newNode });
            } else {
              console.error("no new node created");
            }
          }
        });
      });
    }
    function close() {
      controller.close();
    }
    return {
      displayed,
      nodeId,
      title,
      nodeType,
      nodeTypeInput,
      updateInputsData,
      loading,
      save,
      close
    };
  }
}));

;// CONCATENATED MODULE: ../src/editor/components/widgets/dialogs/polyNode/PolyNodeCreateForm.vue?vue&type=script&lang=ts
 
// EXTERNAL MODULE: ../node_modules/vue-style-loader/index.js!../node_modules/css-loader/dist/cjs.js!../node_modules/vue-loader/dist/stylePostLoader.js!../node_modules/sass-loader/dist/cjs.js??clonedRuleSet-7.use[2]!../node_modules/vue-loader/dist/index.js??ruleSet[1].rules[14].use[0]!../src/editor/components/widgets/dialogs/polyNode/PolyNodeCreateForm.vue?vue&type=style&index=0&id=4ca31ef9&lang=sass
var PolyNodeCreateFormvue_type_style_index_0_id_4ca31ef9_lang_sass = __webpack_require__(17706);
;// CONCATENATED MODULE: ../src/editor/components/widgets/dialogs/polyNode/PolyNodeCreateForm.vue?vue&type=style&index=0&id=4ca31ef9&lang=sass

// EXTERNAL MODULE: ../node_modules/vue-loader/dist/exportHelper.js
var exportHelper = __webpack_require__(6959);
;// CONCATENATED MODULE: ../src/editor/components/widgets/dialogs/polyNode/PolyNodeCreateForm.vue




;


const __exports__ = /*#__PURE__*/(0,exportHelper/* default */.Z)(PolyNodeCreateFormvue_type_script_lang_ts, [['render',render]])

/* harmony default export */ var PolyNodeCreateForm = (__exports__);

/***/ }),

/***/ 17706:
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {

// style-loader: Adds some css to the DOM by adding a <style> tag

// load the styles
var content = __webpack_require__(38065);
if(content.__esModule) content = content.default;
if(typeof content === 'string') content = [[module.id, content, '']];
if(content.locals) module.exports = content.locals;
// add the styles to the DOM
var add = (__webpack_require__(49441)/* ["default"] */ .Z)
var update = add("212b79b6", content, false, {});
// Hot Module Replacement
if(false) {}

/***/ })

}])
//# sourceMappingURL=src_editor_components_widgets_dialogs_polyNode_PolyNodeCreateForm_vue.ef58072cdf1af53cf5b5.js.map